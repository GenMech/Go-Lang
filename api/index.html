<!DOCTYPE html>
<html>
  <head>
    <title>Basic User Interface</title>
  </head>
  <body>
    <h1>Basic User Interface</h1>
    <h2>Add User</h2>
    <form id="addUserForm">
      <label for="username">Username:</label>
      <input type="text" id="username" name="username" required /><br />
      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required /><br />
      <button type="submit">Add User</button>
    </form>
    <h2>Existing Users</h2>
    <table id="usersTable" border="1">
      <tr>
        <th>ID</th>
        <th>Username</th>
        <th>Email</th>
      </tr>
    </table>

    <script>
      // Fetch existing users and populate the table
      fetch("/api/users")
        .then((response) => response.json())
        .then((users) => {
          const table = document.getElementById("usersTable");
          users.forEach((user) => {
            const row = table.insertRow();
            row.insertCell().textContent = user.id;
            row.insertCell().textContent = user.username;
            row.insertCell().textContent = user.email;
          });
        });

      // Add event listener to the form for adding users
      document
        .getElementById("addUserForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          const formData = new FormData(this);
          console.log("formData:", formData);
          fetch("/api/user", {
            method: "POST",
            body: formData,
          })
            .then((response) => {
              response.json(), console.log("response", response);
            })
            .then((user) => {
              const table = document.getElementById("usersTable");
              const row = table.insertRow();
              row.insertCell().textContent = user.id;
              row.insertCell().textContent = user.username;
              row.insertCell().textContent = user.email;
            })
            .catch((error) => console.error("Error:", error));
        });
    </script>
  </body>
</html>
